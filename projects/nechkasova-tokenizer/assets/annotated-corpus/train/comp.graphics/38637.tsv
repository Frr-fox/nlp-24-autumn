from	from	from
:	:	:
rytg7@fel.tno.nl	rytg7@fel.tno.nl	rytg7@fel.tno.nl
(	(	(
q	q	q
.	.	.

van	van	van
rijt	rijt	rijt
)	)	)
subject	subject	subject
:	:	:
re	re	re
:	:	:
sphere	sphere	sphere
from	from	from
4	4	4
points	point	point
?	?	?

organization	organ	organization
:	:	:
tno	tno	tno
physics	physic	physic
and	and	and
electronics	electron	electronics
laboratory	laboratori	laboratory

lines	line	line
:	:	:
26	26	26

there	there	there
is	is	is
another	anoth	another
useful	use	useful
method	method	method
based	base	based
on	on	on
least	least	least
sqyares	sqyar	sqyares
estimation	estim	estimation
of	of	of
the	the	the
sphere	sphere	sphere
equation	equat	equation
parameters	paramet	parameter
.	.	.

the	the	the
points	point	point
(	(	(
x	x	x
,	,	,
y	y	y
,	,	,
z	z	z
)	)	)
on	on	on
a	a	a
spherical	spheric	spherical
surface	surfac	surface
with	with	with
radius	radius	radius
r	r	r
and	and	and
center	center	center
(	(	(
a	a	a
,	,	,
b	b	b
,	,	,
c	c	c
)	)	)
can	can	can
be	be	be
written	written	written
as	as	a

(	(	(
x	x	x
-	-	-
a	a	a
)	)	)
^	^	^
2	2	2
+	+	+
(	(	(
y	y	y
-	-	-
b	b	b
)	)	)
^	^	^
2	2	2
+	+	+
(	(	(
z	z	z
-	-	-
c	c	c
)	)	)
^	^	^
2	2	2
=	=	=
r	r	r
^	^	^
2	2	2

this	this	this
equation	equat	equation
can	can	can
be	be	be
rewritten	rewritten	rewritten
into	into	into
the	the	the
following	follow	following
form	form	form
:	:	:

2ax	2ax	2ax
+	+	+
2by	2bi	2by
+	+	+
2cz	2cz	2cz
+	+	+
r	r	r
^	^	^
2	2	2
-	-	-
a	a	a
^	^	^
2	2	2
-	-	-
b	b	b
^	^	^
2	2	2
-	-	-
c	c	c
^	^	^
2	2	2
=	=	=
x	x	x
^	^	^
2	2	2
+	+	+
y	y	y
^	^	^
2	2	2
+	+	+
z	z	z
^	^	^
2	2	2

approximate	approxim	approximate
the	the	the
left	left	left
hand	hand	hand
part	part	part
by	by	by
f	f	f
(	(	(
x	x	x
,	,	,
y	y	y
,	,	,
z	z	z
)	)	)
=	=	=
p1	p1	p1
.	.	.
x	x	x
+	+	+
p2	p2	p2
.	.	.
x	x	x
+	+	+
p3	p3	p3
.	.	.
z	z	z
+	+	+
p4	p4	p4
.	.	.
1	1	1

for	for	for
all	all	all
datapoints	datapoint	datapoints
,	,	,
i	i	i
.	.	.
c	c	c
.	.	.
4	4	4
,	,	,
determine	determin	determine
the	the	the
4	4	4
parameters	paramet	parameter
p1	p1	p1
.	.	.
.	.	.
p4	p4	p4
which	which	which
minimise	minimis	minimise
the	the	the
average	averag	average
error	error	error
|	|	|
f	f	f
(	(	(
x	x	x
,	,	,
y	y	y
,	,	,
z	z	z
)	)	)
-	-	-
x	x	x
^	^	^
2	2	2
-	-	-
y	y	y
^	^	^
2	2	2
-	-	-
z	z	z
^	^	^
2	2	2
|	|	|
^	^	^
2	2	2
.	.	.

in	in	in
'	'	'
numerical	numer	numerical
recipes	recip	recipe
in	in	in
c	c	c
'	'	'
can	can	can
be	be	be
found	found	found
algorithms	algorithm	algorithm
to	to	to
solve	solv	solve
these	these	these
parameters	paramet	parameter
.	.	.

the	the	the
best	best	best
fitting	fit	fitting
sphere	sphere	sphere
will	will	will
have	have	have

-	-	-
center	center	center
(	(	(
a	a	a
,	,	,
b	b	b
,	,	,
c	c	c
)	)	)
=	=	=
(	(	(
p1	p1	p1
/	/	/
2	2	2
,	,	,
p2	p2	p2
/	/	/
2	2	2
,	,	,
p3	p3	p3
/	/	/
2	2	2
)	)	)

-	-	-
radius	radius	radius
r	r	r
=	=	=
sqrt	sqrt	sqrt
(	(	(
p4	p4	p4
+	+	+
a	a	a
.	.	.
a	a	a
+	+	+
b	b	b
.	.	.
b	b	b
+	+	+
c	c	c
.	.	.
c	c	c
)	)	)
.	.	.

so	so	so
,	,	,
at	at	at
last	last	last
,	,	,
will	will	will
this	this	this
solve	solv	solve
you	you	you
sphere	sphere	sphere
estination	estin	estination
problem	problem	problem
,	,	,
at	at	at
least	least	least
for	for	for
the	the	the
most	most	most
situations	situat	situation
i	i	i
think	think	think
?	?	?
.	.	.

quick	quick	quick
van	van	van
rijt	rijt	rijt
,	,	,
rytg7@fel.tno.nl	rytg7@fel.tno.nl	rytg7@fel.tno.nl