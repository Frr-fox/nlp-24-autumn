from	from	from
:	:	:
smb@research.att.com	smb@research.att.com	smb@research.att.com
(	(	(
steven	steven	steven
bellovin	bellovin	bellovin
)	)	)

subject	subject	subject
:	:	:
more	more	more
technical	technic	technical
details	detail	detail

organization	organ	organization
:	:	:
at	at	at
&	&	&
t	t	t
bell	bell	bell
laboratories	laboratori	laboratory

lines	line	line
:	:	:
116	116	116

here	here	here
are	are	are
some	some	some
corrections	correct	correction
and	and	and
additions	addit	addition
to	to	to
hellman	hellman	hellman
'	'	'
s	s	s
note	note	note
,	,	,
courtesy	courtesi	courtesy
of	of	of
dorothy	dorothi	dorothy
denning	den	denning
.	.	.

again	again	again
,	,	,
this	this	this
is	is	is
reposted	repost	reposted
with	with	with
permission	permiss	permission
.	.	.

two	two	two
requests	request	request
-	-	-
-	-	-
first	first	first
,	,	,
note	note	note
the	the	the
roles	role	role
of	of	of
s1	s1	s1
and	and	and
s2	s2	s2
.	.	.

it	it	it
appears	appear	appears
to	to	to
me	me	me
and	and	and
others	other	others
that	that	that
anyone	anyon	anyone
who	who	who
knows	know	know
those	those	those
values	valu	value
can	can	can
construct	construct	construct
the	the	the
unit	unit	unit
key	key	key
.	.	.

and	and	and
the	the	the
nature	natur	nature
of	of	of
the	the	the
generation	generat	generation
process	process	process
for	for	for
k1	k1	k1
and	and	and
k2	k2	k2
is	is	is
such	such	such
that	that	that
neither	neither	neither
can	can	can
be	be	be
produced	produc	produced
alone	alon	alone
.	.	.

thus	thus	thus
,	,	,
the	the	the
scheme	scheme	scheme
cannot	cannot	cannot
be	be	be
implemented	implement	implemented
such	such	such
that	that	that
one	one	one
repository	repositori	repository
generates	generat	generates
the	the	the
first	first	first
half	half	half
-	-	-
key	key	key
,	,	,
and	and	and
another	anoth	another
generates	generat	generates
the	the	the
second	second	second
.	.	.

*	*	*
that	that	that
*	*	*
is	is	is
ominous	omin	ominous
.	.	.

second	second	second
-	-	-
-	-	-
these	these	these
postings	post	posting
are	are	are
not	not	not
revealed	reveal	revealed
scripture	scriptur	scripture
,	,	,
nor	nor	nor
are	are	are
they	they	they
carefully	care	carefully
-	-	-
crafted	craft	crafted
spook	spook	spook
postings	post	posting
.	.	.

don	don	don
'	'	'
t	t	t
attempt	attempt	attempt
to	to	to
draw	draw	draw
out	out	out
hidden	hidden	hidden
meanings	mean	meaning
(	(	(
as	as	a
opposed	oppos	opposed
to	to	to
,	,	,
say	say	say
,	,	,
the	the	the
official	offici	official
announcements	announc	announcement
of	of	of
clipper	clipper	clipper
)	)	)
.	.	.

leave	leav	leave
denning	den	denning
out	out	out
of	of	of
this	this	this
;	;	;
given	given	given
hellman	hellman	hellman
'	'	'
s	s	s
record	record	record
of	of	of
opposition	opposit	opposition
to	to	to
des	des	de
,	,	,
which	which	which
goes	goe	go
back	back	back
before	befor	before
some	some	some
folks	folk	folk
on	on	on
this	this	this
newsgroup	newsgroup	newsgroup
knew	knew	knew
how	how	how
to	to	to
read	read	read
,	,	,
i	i	i
don	don	don
'	'	'
t	t	t
think	think	think
you	you	you
can	can	can
impugn	impugn	impugn
his	his	his
integrity	integr	integrity
.	.	.

oh	oh	oh
yeah	yeah	yeah
-	-	-
-	-	-
the	the	the
folks	folk	folk
who	who	who
invented	invent	invented
clipper	clipper	clipper
aren	aren	aren
'	'	'
t	t	t
stupid	stupid	stupid
.	.	.

if	if	if
you	you	you
think	think	think
something	someth	something
doesn	doesn	doesn
'	'	'
t	t	t
make	make	make
sense	sens	sense
,	,	,
it	it	it
'	'	'
s	s	s
almost	almost	almost
certainly	certain	certainly
because	becaus	because
you	you	you
don	don	don
'	'	'
t	t	t
understand	understand	understand
their	their	their
goals	goal	goal
.	.	.

-	-	-
-	-	-
steve	steve	steve
bellovin	bellovin	bellovin

-	-	-
-	-	-
-	-	-
-	-	-
-	-	-

date	date	date
:	:	:
sun	sun	sun
,	,	,
18	18	18
apr	apr	apr
93	93	93
07	07	07
:	:	:
56	56	56
:	:	:
39	39	39
edt	edt	edt

from	from	from
:	:	:
denning@cs.georgetown.edu	denning@cs.georgetown.edu	denning@cs.georgetown.edu
(	(	(
dorothy	dorothi	dorothy
denning	den	denning
)	)	)

subject	subject	subject
:	:	:
re	re	re
:	:	:
clipper	clipper	clipper
chip	chip	chip

to	to	to
:	:	:
(	(	(
a	a	a
long	long	long
list	list	list
of	of	of
folks	folk	folk
)	)	)

i	i	i
was	was	wa
also	also	also
briefed	brief	briefed
by	by	by
the	the	the
nsa	nsa	nsa
and	and	and
fbi	fbi	fbi
,	,	,
so	so	so
let	let	let
me	me	me
add	add	add
a	a	a
few	few	few
comments	comment	comment
to	to	to
marty	marti	marty
'	'	'
s	s	s
message	messag	message
:	:	:

the	the	the
clipper	clipper	clipper
chip	chip	chip
will	will	will
have	have	have
a	a	a
secret	secret	secret
crypto	crypto	crypto
algorithm	algorithm	algorithm
embedded	embed	embedded
in	in	in

the	the	the
algorithm	algorithm	algorithm
operates	oper	operates
on	on	on
64	64	64
-	-	-
bit	bit	bit
blocks	block	block
(	(	(
like	like	like
des	des	de
)	)	)
and	and	and
the	the	the
chip	chip	chip
supports	support	support
all	all	all
4	4	4
des	des	de
modes	mode	mode
of	of	of
operation	oper	operation
.	.	.

the	the	the
algorithm	algorithm	algorithm
uses	use	us
32	32	32
rounds	round	round
of	of	of
scrambling	scrambl	scrambling
compared	compar	compared
with	with	with
16	16	16
in	in	in
des	des	de
.	.	.

in	in	in
addition	addit	addition
to	to	to
the	the	the
system	system	system
key	key	key
,	,	,
each	each	each
user	user	user
will	will	will
get	get	get
to	to	to
choose	choos	choose
his	his	his

or	or	or
her	her	her
own	own	own
key	key	key
and	and	and
change	chang	change
it	it	it
as	as	a
often	often	often
as	as	a
desired	desir	desired
.	.	.

call	call	call
this	this	this
key	key	key

plain	plain	plain
old	old	old
k	k	k
.	.	.

when	when	when
a	a	a
message	messag	message
is	is	is
to	to	to
be	be	be
sent	sent	sent
it	it	it
will	will	will
first	first	first
be	be	be

k	k	k
is	is	is
the	the	the
session	session	session
key	key	key
shared	share	shared
by	by	by
the	the	the
sender	sender	sender
and	and	and
receiver	receiv	receiver
.	.	.

any	ani	any
method	method	method

(	(	(
e	e	e
.	.	.
g	g	g
.	.	.
,	,	,
public	public	public
key	key	key
)	)	)
can	can	can
be	be	be
used	use	used
to	to	to
establish	establish	establish
the	the	the
session	session	session
key	key	key
.	.	.

in	in	in
the	the	the
at	at	at
&	&	&
t	t	t
telephone	telephon	telephone
security	secur	security
devices	devic	device
,	,	,
which	which	which
will	will	will
have	have	have
the	the	the
new	new	new
chip	chip	chip
,	,	,
the	the	the
key	key	key
is	is	is
negotiated	negoti	negotiated
using	use	using
a	a	a
public	public	public
-	-	-
key	key	key
protocol	protocol	protocol
.	.	.

encrypted	encrypt	encrypted
under	under	under
k	k	k
,	,	,
then	then	then
k	k	k
will	will	will
be	be	be
encrypted	encrypt	encrypted
under	under	under
the	the	the
unit	unit	unit
key	key	key
uk	uk	uk
,	,	,

and	and	and
the	the	the
serial	serial	serial
number	number	number
of	of	of
the	the	the
unit	unit	unit
added	ad	added
to	to	to
produce	produc	produce
a	a	a
three	three	three
part	part	part

message	messag	message
which	which	which
will	will	will
then	then	then
be	be	be
encrypted	encrypt	encrypted
under	under	under
the	the	the
system	system	system
key	key	key
sk	sk	sk

producing	produc	producing

e	e	e
{	{	{
e	e	e
[	[	[
m	m	m
;	;	;
k	k	k
]	]	]
,	,	,
e	e	e
[	[	[
k	k	k
;	;	;
uk	uk	uk
]	]	]
,	,	,
serial	serial	serial
number	number	number
;	;	;
sk	sk	sk
}	}	}

my	my	my
understanding	understand	understanding
is	is	is
that	that	that
e	e	e
[	[	[
m	m	m
;	;	;
k	k	k
]	]	]
is	is	is
not	not	not
encrypted	encrypt	encrypted
under	under	under
sk	sk	sk
(	(	(
called	call	called
the	the	the

"	"	"
family	famili	family
key	key	key
"	"	"
)	)	)
and	and	and
that	that	that
the	the	the
decrypt	decrypt	decrypt
key	key	key
corresponding	correspond	corresponding
to	to	to
sk	sk	sk
is	is	is
held	held	held
by	by	by
law	law	law
enforcement	enforc	enforcement
.	.	.

does	doe	doe
anyone	anyon	anyone
have	have	have
first	first	first
hand	hand	hand
knowledge	knowledg	knowledge
on	on	on
this	this	this
?	?	?

i	i	i
will	will	will
also	also	also
check	check	check
it	it	it
out	out	out
,	,	,
but	but	but
this	this	this
is	is	is
7am	7am	7am
sunday	sunday	sunday
so	so	so
i	i	i
did	did	did
not	not	not
want	want	want
to	to	to
wait	wait	wait
.	.	.

the	the	the
unit	unit	unit
key	key	key

will	will	will
be	be	be
generated	generat	generated
as	as	a
the	the	the
xor	xor	xor
of	of	of
two	two	two
80	80	80
-	-	-
bit	bit	bit
random	random	random
numbers	number	number
k1	k1	k1

and	and	and
k2	k2	k2
(	(	(
uk	uk	uk
=	=	=
k1	k1	k1
+	+	+
k2	k2	k2
)	)	)
which	which	which
will	will	will
be	be	be
kept	kept	kept
by	by	by
the	the	the
two	two	two
escrow	escrow	escrow

the	the	the
unit	unit	unit
key	key	key
,	,	,
also	also	also
called	call	called
the	the	the
"	"	"
chip	chip	chip
key	key	key
,	,	,
"	"	"
is	is	is
generated	generat	generated
from	from	from
the	the	the
serial	serial	serial
number	number	number
n	n	n
as	as	a
follows	follow	follows
.	.	.

let	let	let
n1	n1	n1
,	,	,
n2	n2	n2
,	,	,
and	and	and
n3	n3	n3
be	be	be
64	64	64
bit	bit	bit
blocks	block	block
derived	deriv	derived
from	from	from
n	n	n
,	,	,
and	and	and
let	let	let
s1	s1	s1
and	and	and
s2	s2	s2
be	be	be
two	two	two
80	80	80
-	-	-
bit	bit	bit
seeds	seed	seed
used	use	used
as	as	a
keys	key	key
.	.	.

compute	comput	compute
the	the	the
64	64	64
-	-	-
bit	bit	bit
block	block	block

r1	r1	r1
=	=	=
e	e	e
[	[	[
d	d	d
[	[	[
e	e	e
[	[	[
n1	n1	n1
;	;	;
s1	s1	s1
]	]	]
;	;	;
s2	s2	s2
]	]	]
;	;	;
s1	s1	s1
]	]	]

(	(	(
note	note	note
that	that	that
this	this	this
is	is	is
like	like	like
using	use	using
the	the	the
des	des	de
in	in	in
triple	tripl	triple
encryption	encrypt	encryption
mode	mode	mode
with	with	with
two	two	two
keys	key	key
.	.	.
)	)	)
similarly	similar	similarly
compute	comput	compute
blocks	block	block
r2	r2	r2
and	and	and
r3	r3	r3
starting	start	starting
with	with	with
n2	n2	n2
and	and	and
n3	n3	n3
.	.	.

(	(	(
i	i	i
'	'	'
m	m	m
unlear	unlear	unlear
about	about	about
whether	whether	whether
the	the	the
keys	key	key
s1	s1	s1
and	and	and
s2	s2	s2
change	chang	change
.	.	.

the	the	the
fact	fact	fact
that	that	that
they	they	they
'	'	'
re	re	re
called	call	called
seeds	seed	seed
suggests	suggest	suggests
they	they	they
might	might	might
.	.	.
)	)	)
then	then	then
r1	r1	r1
,	,	,
r2	r2	r2
,	,	,
and	and	and
r3	r3	r3
are	are	are
concatenated	concaten	concatenated
together	togeth	together
giving	give	giving
192	192	192
bits	bit	bit
.	.	.

the	the	the
first	first	first
80	80	80
bits	bit	bit
form	form	form
k1	k1	k1
and	and	and
the	the	the
next	next	next
80	80	80
bits	bit	bit
form	form	form
k2	k2	k2
.	.	.

the	the	the
remaining	remain	remaining
bits	bit	bit
are	are	are
discarded	discard	discarded
.	.	.

authorities	author	authority
.	.	.

who	who	who
these	these	these
escrow	escrow	escrow
authorities	author	authority
will	will	will
be	be	be
is	is	is
still	still	still
to	to	to
be	be	be

decided	decid	decided
by	by	by
the	the	the
attorney	attorney	attorney
general	general	general
,	,	,
but	but	but
it	it	it
was	was	wa
stressed	stress	stressed
to	to	to
me	me	me
that	that	that

they	they	they
will	will	will
not	not	not
be	be	be
nsa	nsa	nsa
or	or	or
law	law	law
enforcement	enforc	enforcement
agencies	agenc	agency
,	,	,
that	that	that
they	they	they

must	must	must
be	be	be
parties	parti	party
acceptable	accept	acceptable
to	to	to
the	the	the
users	user	user
of	of	of
the	the	the
system	system	system
as	as	a
unbiased	unbias	unbiased
.	.	.

marty	marti	marty
is	is	is
right	right	right
on	on	on
this	this	this
and	and	and
the	the	the
fbi	fbi	fbi
has	has	ha
asked	ask	asked
me	me	me
for	for	for
suggestions	suggest	suggestion
.	.	.

please	pleas	please
pass	pass	pas
them	them	them
to	to	to
me	me	me
along	along	along
with	with	with
your	your	your
reasons	reason	reason
.	.	.

in	in	in
addition	addit	addition
to	to	to
marty	marti	marty
'	'	'
s	s	s
criteria	criteria	criterion
,	,	,
i	i	i
would	would	would
add	add	add
that	that	that
the	the	the
agencies	agenc	agency
must	must	must
have	have	have
an	an	an
established	establish	established
record	record	record
of	of	of
being	be	being
able	abl	able
to	to	to
safeguard	safeguard	safeguard
highly	high	highly
sensitive	sensit	sensitive
information	inform	information
.	.	.

some	some	some
suggestions	suggest	suggestion
i	i	i
'	'	'
ve	ve	ve
received	receiv	received
so	so	so
far	far	far
include	includ	include
sri	sri	sri
,	,	,
rand	rand	rand
,	,	,
mitre	mitr	mitre
,	,	,
the	the	the
national	nation	national
labs	lab	lab
(	(	(
sandia	sandia	sandia
,	,	,
lanl	lanl	lanl
,	,	,
los	los	los
alamos	alamo	alamo
)	)	)
,	,	,
treasury	treasuri	treasury
,	,	,
gao	gao	gao
.	.	.

when	when	when
a	a	a
court	court	court
order	order	order
obtains	obtain	obtains
k1	k1	k1
and	and	and
k2	k2	k2
,	,	,
and	and	and
thence	thenc	thence
k	k	k
,	,	,
the	the	the
law	law	law

enforcement	enforc	enforcement
agency	agenc	agency
will	will	will
use	use	use
sk	sk	sk
to	to	to
decrypt	decrypt	decrypt
all	all	all
information	inform	information

flowing	flow	flowing
on	on	on
the	the	the
suspected	suspect	suspected
link	link	link
[	[	[
aside	asid	aside
:	:	:
it	it	it
is	is	is
my	my	my
guess	guess	guess
that	that	that

they	they	they
may	may	may
do	do	do
this	this	this
constantly	constant	constantly
on	on	on
all	all	all
links	link	link
,	,	,
with	with	with
or	or	or
without	without	without
a	a	a

court	court	court
order	order	order
,	,	,
since	sinc	since
it	it	it
is	is	is
almost	almost	almost
impossible	imposs	impossible
to	to	to
tell	tell	tell
which	which	which
links	link	link

over	over	over
which	which	which
a	a	a
message	messag	message
will	will	will
flow	flow	flow
.	.	.
]	]	]

my	my	my
understanding	understand	understanding
is	is	is
that	that	that
there	there	there
will	will	will
be	be	be
only	onli	only
one	one	one
decode	decod	decode
box	box	box
and	and	and
that	that	that
it	it	it
will	will	will
be	be	be
operated	oper	operated
by	by	by
the	the	the
fbi	fbi	fbi
.	.	.

the	the	the
service	servic	service
provider	provid	provider
will	will	will
isolate	isol	isolate
the	the	the
communications	communic	communication
stream	stream	stream
and	and	and
pass	pass	pas
it	it	it
to	to	to
the	the	the
fbi	fbi	fbi
where	where	where
it	it	it
will	will	will
pass	pass	pas
through	through	through
the	the	the
decode	decod	decode
box	box	box
,	,	,
which	which	which
will	will	will
have	have	have
been	been	been
keyed	key	keyed
with	with	with
k	k	k
.	.	.

for	for	for
"	"	"
the	the	the
wiretap	wiretap	wiretap
authorizations	author	authorization
.	.	.
"	"	"
when	when	when
levy	levi	levy
asked	ask	asked
for	for	for

the	the	the
details	detail	detail
so	so	so
he	he	he
could	could	could
review	review	review
the	the	the
cases	case	case
as	as	a
required	requir	required
by	by	by

law	law	law
,	,	,
the	the	the
agent	agent	agent
told	told	told
him	him	him
that	that	that
his	his	his
predecessors	predecessor	predecessor
just	just	just
turned	turn	turned

over	over	over
40	40	40
-	-	-
50	50	50
blank	blank	blank
,	,	,
signed	sign	signed
forms	form	form
every	everi	every
time	time	time
.	.	.

levi	levi	levi
did	did	did
not	not	not

comply	compli	comply
and	and	and
changed	chang	changed
the	the	the
system	system	system
,	,	,
but	but	but
the	the	the
lesson	lesson	lesson
is	is	is
clear	clear	clear
:	:	:

no	no	no
single	singl	single
person	person	person
or	or	or
authority	author	authority
should	should	should
have	have	have
the	the	the
power	power	power
to	to	to

authorize	author	authorize
wiretaps	wiretap	wiretap

no	no	no
single	singl	single
person	person	person
does	doe	doe
,	,	,
at	at	at
least	least	least
for	for	for
fbi	fbi	fbi
taps	tap	tap
.	.	.

after	after	after
completing	complet	completing
a	a	a
mound	mound	mound
of	of	of
paperwork	paperwork	paperwork
,	,	,
an	an	an
agent	agent	agent
must	must	must
get	get	get
the	the	the
approval	approv	approval
of	of	of
several	sever	several
people	peopl	people
on	on	on
a	a	a
chain	chain	chain
that	that	that
includes	includ	includes
fbi	fbi	fbi
legal	legal	legal
counsel	counsel	counsel
before	befor	before
the	the	the
request	request	request
is	is	is
even	even	even
taken	taken	taken
to	to	to
the	the	the
attorney	attorney	attorney
general	general	general
for	for	for
final	final	final
approval	approv	approval
.	.	.

dorothy	dorothi	dorothy
denning	den	denning