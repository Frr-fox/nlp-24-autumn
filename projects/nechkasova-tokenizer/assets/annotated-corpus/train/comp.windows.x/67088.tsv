from	from	from
:	:	:
leec@cb-iris.stanford.edu	leec@cb-iris.stanford.edu	leec@cb-iris.stanford.edu
(	(	(
christopher	christoph	christopher
lee	lee	lee
)	)	)

subject	subject	subject
:	:	:
help	help	help
!	!	!

setting	set	setting
colormaps	colormap	colormaps
on	on	on
multi	multi	multi
-	-	-
top	top	top
-	-	-
level	level	level
app	app	app
keywords	keyword	keywords
:	:	:
glx	glx	glx
mixed	mix	mixed
-	-	-
model	model	model
,	,	,
colormap	colormap	colormap
organization	organ	organization
:	:	:
dsg	dsg	dsg
,	,	,
stanford	stanford	stanford
university	univers	university
,	,	,
ca	ca	ca
94305	94305	94305
,	,	,
usa	usa	usa
lines	line	line
:	:	:
71	71	71

dear	dear	dear
sgi	sgi	sgi
and	and	and
netter	netter	netter
gl	gl	gl
-	-	-
x	x	x
mixed	mix	mixed
-	-	-
model	model	model
experts	expert	expert
,	,	,
i	i	i
am	am	am
writing	write	writing
a	a	a
mixed	mix	mixed
model	model	model
application	applic	application
that	that	that
creates	creat	creates
a	a	a
couple	coupl	couple
different	differ	different
color	color	color
maps	map	map
for	for	for
different	differ	different
windows	window	window
,	,	,
and	and	and
i	i	i
'	'	'
ve	ve	ve
been	been	been
having	have	having
trouble	troubl	trouble
getting	get	getting
the	the	the
window	window	window
manager	manag	manager
to	to	to
reliably	reliabl	reliably
honor	honor	honor
my	my	my
requests	request	request
.	.	.

in	in	in
some	some	some
environments	environ	environment

(	(	(
entry	entri	entry
level	level	level
r3000	r3000	r3000
indigo	indigo	indigo
w	w	w
/	/	/
4	4	4
.	.	.
0	0	0
.	.	.
5	5	5
)	)	)
all	all	all
windows	window	window
are	are	are
getting	get	getting
properly	proper	properly
connected	connect	connected
to	to	to
their	their	their
designated	design	designated
color	color	color
maps	map	map
,	,	,
but	but	but
on	on	on
others	other	others
(	(	(
an	an	an
iris	iri	iris
4d	4d	4d
240	240	240
/	/	/
gtx	gtx	gtx
;	;	;
also	also	also
a	a	a
different	differ	different
entry	entri	entry
level	level	level
indigo	indigo	indigo
)	)	)
the	the	the
color	color	color
mapping	map	mapping
is	is	is
unreliable	unreli	unreliable
and	and	and
changes	chang	change
behavior	behavior	behavior
when	when	when
i	i	i
compile	compil	compile
at	at	at
different	differ	different
times	time	time
.	.	.

the	the	the
most	most	most
common	common	common
problem	problem	problem
is	is	is
that	that	that
all	all	all
non	non	non
-	-	-
top	top	top
-	-	-
level	level	level
windows	window	window
fail	fail	fail
to	to	to
be	be	be
displayed	display	displayed
according	accord	according
to	to	to
their	their	their
colormap	colormap	colormap
.	.	.

my	my	my
application	applic	application
starts	start	start
out	out	out
by	by	by
creating	creat	creating
three	three	three
top	top	top
-	-	-
level	level	level
windows	window	window
;	;	;
in	in	in
some	some	some
cases	case	case
all	all	all
but	but	but
the	the	the
first	first	first
of	of	of
these	these	these
also	also	also
fail	fail	fail
to	to	to
be	be	be
displayed	display	displayed
by	by	by
their	their	their
colormap	colormap	colormap
.	.	.

this	this	this
is	is	is
spectacularly	spectacular	spectacularly
aggravating	aggrav	aggravating
.	.	.

i	i	i
would	would	would
dearly	dear	dearly
appreciate	appreci	appreciate

1	1	1
.	.	.

an	an	an
explanation	explan	explanation
of	of	of
the	the	the
standard	standard	standard
,	,	,
right	right	right
,	,	,
correct	correct	correct
way	way	way
to	to	to
give	give	give
a	a	a
window	window	window

a	a	a
colormap	colormap	colormap
such	such	such
that	that	that
the	the	the
window	window	window
manager	manag	manager
will	will	will
honor	honor	honor
and	and	and
obey	obey	obey
it	it	it
;	;	;

2	2	2
.	.	.

any	ani	any
advice	advic	advice
about	about	about
problems	problem	problem
that	that	that
could	could	could
cause	caus	cause
my	my	my
failure	failur	failure
to	to	to
get	get	get
my	my	my

desired	desir	desired
colormaps	colormap	colormaps
.	.	.

by	by	by
now	now	now
i	i	i
have	have	have
exhausted	exhaust	exhausted
my	my	my
own	own	own
attempts	attempt	attempt
on	on	on
this	this	this
,	,	,
having	have	having
tried	tri	tried
everything	everyth	everything
reasonable	reason	reasonable
or	or	or
imaginable	imagin	imaginable
.	.	.

below	below	below
is	is	is
example	exampl	example
code	code	code
giving	give	giving
the	the	the
schematic	schemat	schematic
for	for	for
how	how	how
i	i	i
have	have	have
been	been	been
*	*	*
trying	tri	trying
*	*	*
to	to	to
do	do	do
this	this	this
.	.	.

please	pleas	please
,	,	,
please	pleas	please
,	,	,
please	pleas	please
somebody	somebodi	somebody
tell	tell	tell
me	me	me
what	what	what
i	i	i
am	am	am
doing	do	doing
wrong	wrong	wrong
/	/	/
how	how	how
to	to	to
do	do	do
it	it	it
right	right	right
!	!	!
!	!	!
!	!	!

yours	your	yours
,	,	,
chris	chris	chris
lee	lee	lee

/	/	/
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
*	*	*
/	/	/
display	display	display
*	*	*
dpy	dpi	dpy
;	;	;
/	/	/
*	*	*
declare	declar	declare
some	some	some
data	data	data
.	.	.
.	.	.
.	.	.

*	*	*
/	/	/
colormap	colormap	colormap
popup_cmap	popup_cmap	popup_cmap
;	;	;
xcolor	xcolor	xcolor
mycolor	mycolor	mycolor
;	;	;
window	window	window
win	win	win
;	;	;
xsetwindowattributes	xsetwindowattribut	xsetwindowattributes
cwa	cwa	cwa
;	;	;
int	int	int
nwlist	nwlist	nwlist
;	;	;
window	window	window
*	*	*
wlist	wlist	wlist
;	;	;

/	/	/
*	*	*
nb	nb	nb
:	:	:
for	for	for
brevity	breviti	brevity
,	,	,
not	not	not
showing	show	showing
all	all	all
code	code	code
lines	line	line
-	-	-
-	-	-
just	just	just
a	a	a
schematic	schemat	schematic
*	*	*
/	/	/

popup_cmap	popup_cmap	popup_cmap
=	=	=
xcreatecolormap	xcreatecolormap	xcreatecolormap
(	(	(
dpy	dpi	dpy
,	,	,
defaultrootwindow	defaultrootwindow	defaultrootwindow
(	(	(
dpy	dpi	dpy
)	)	)
,	,	,
vis	vis	vi
-	-	-
>	>	>
visual	visual	visual
,	,	,
allocall	allocal	allocall
)	)	)
;	;	;

/	/	/
*	*	*
here	here	here
we	we	we
store	store	store
a	a	a
bunch	bunch	bunch
of	of	of
colors	color	color
using	use	using

xstorecolor	xstorecolor	xstorecolor
(	(	(
dpy	dpi	dpy
,	,	,
popup_cmap	popup_cmap	popup_cmap
,	,	,
&	&	&
mycolor	mycolor	mycolor
)	)	)
;	;	;
.	.	.
.	.	.
.	.	.

*	*	*
/	/	/

cwa	cwa	cwa
.	.	.
colormap	colormap	colormap
=	=	=
popup_cmap	popup_cmap	popup_cmap
;	;	;
win	win	win
=	=	=
xcreatewindow	xcreatewindow	xcreatewindow
(	(	(
dpy	dpi	dpy
,	,	,
parent	parent	parent
,	,	,
x	x	x
,	,	,
y	y	y
,	,	,
w	w	w
,	,	,
h	h	h
,	,	,
borderwidth	borderwidth	borderwidth
,	,	,
vis	vis	vi
-	-	-
>	>	>
depth	depth	depth
,	,	,
inputoutput	inputoutput	inputoutput
,	,	,
vis	vis	vi
-	-	-
>	>	>
visual	visual	visual
,	,	,
cwcolormap	cwcolormap	cwcolormap
|	|	|
cwborderpixel	cwborderpixel	cwborderpixel
,	,	,
&	&	&
cwa	cwa	cwa
)	)	)
;	;	;

/	/	/
*	*	*
list	list	list
all	all	all
sub	sub	sub
windows	window	window
of	of	of
my_topwin	my_topwin	my_topwin
,	,	,
parent	parent	parent
of	of	of
win	win	win
,	,	,
into	into	into
wlist	wlist	wlist
;	;	;

nwlist	nwlist	nwlist
is	is	is
counter	counter	counter
of	of	of
entries	entri	entry
in	in	in
wlist	wlist	wlist
.	.	.

nb	nb	nb
:	:	:
wlist	wlist	wlist
is	is	is
static	static	static
storage	storag	storage
that	that	that
can	can	can
be	be	be
relied	reli	relied
on	on	on
not	not	not
to	to	to
go	go	go
away	away	away

or	or	or
be	be	be
corrupted	corrupt	corrupted
.	.	.

i	i	i
thought	thought	thought
of	of	of
that	that	that
!	!	!

does	doe	doe
anyone	anyon	anyone
know	know	know
if	if	if

setting	set	setting
wm	wm	wm
properties	properti	property
is	is	is
by	by	by
data	data	data
copy	copi	copy
,	,	,
or	or	or
by	by	by
reference	refer	reference
pointer	pointer	pointer
?	?	?

ie	ie	ie
.	.	.

is	is	is
it	it	it
acceptable	accept	acceptable
to	to	to
pass	pass	pas
data	data	data
for	for	for
a	a	a
property	properti	property
,	,	,
then	then	then
free	free	free

the	the	the
data	data	data
?	?	?

*	*	*
/	/	/
xsetwmcolormapwindows	xsetwmcolormapwindow	xsetwmcolormapwindows
(	(	(
dpy	dpi	dpy
,	,	,
my_topwin	my_topwin	my_topwin
,	,	,
wlist	wlist	wlist
,	,	,
nwlist	nwlist	nwlist
)	)	)
;	;	;

xmapraised	xmaprais	xmapraised
(	(	(
display0	display0	display0
,	,	,
win	win	win
)	)	)
;	;	;

/	/	/
*	*	*
later	later	later
on	on	on
we	we	we
handle	handl	handle
xevents	xevent	xevents
normally	normal	normally
.	.	.
.	.	.
.	.	.

typical	typic	typical
eventloop	eventloop	eventloop
*	*	*
/	/	/